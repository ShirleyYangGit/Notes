# OAuth 2.0
OAuth的作用就是让"客户端"安全可控地获取"用户"的授权，与"服务商提供商"进行互动。

- [传统认证的问题](#传统认证的问题)
- [OAuth2的解决思路](#OAuth2的解决思路)
- [OAuth2简介](#OAuth2简介)
    - [名词定义](#名词定义)
 
# 传统认证的问题 
举个简单一点的例子来说明传统身份认证的问题:

> 你有一座别墅, 这个别墅是你的资产, 清洁公司提供别墅清洁服务(第三方服务商), 园艺公司提供修剪花园的服务(第三方服务商), 而进入你别墅的凭证就是别墅的钥匙, 如果你直接将钥匙(资产访问凭证)给这2个服务商, 这是很危险的, 因为他们也可以复制你的钥匙, 此时你的别墅的安全体系就崩塌了, 假如你真的很信任他们, 但是如果园艺公司的人有问题, 他可能盗走了你给他的钥匙, 此时咋办, 唯有换锁, 但是锁换了 别墅的清洁服务也会受到影响, 因此你会发现 把钥匙直接给第三方是很不安全的, 会引发很多安全隐患问题。

# OAuth2的解决思路
对于上面的栗子, 当有多个第三方服务商要访问我们的资源时(进入别墅), 仅通过1把锁的方式来保证资产的安全访问是很成问题的, 因此我们需要一层中间层来管理这些人的访问权限, 常见的做法是招一个管家, 每次访问时由管家询问别墅主人进行授权。

OAuth的实现方式与此类似, OAuth在”客户端”(第三方服务)与”服务提供商”(用户自己的资产服务)之间，设置了一个授权层(类似于上面的管家)。”客户端”不能直接登录”服务提供商”(第三方无法直接进入别墅), 只能登录授权层(询问管家)，以此将用户(资产的主人)与客户端(第三方)区分开来。

“客户端”登录授权层所用的令牌(token), 与用户的密码不同。用户可以在登录的时候，指定授权层令牌的权限范围和有效期。”客户端”登录授权层以后，”服务提供商”根据令牌的权限范围和有效期，向”客户端”开放用户资产访问的权限。

# OAuth2简介

## 名词定义
（1）Third-party application：第三方应用程序，本文中又称"客户端"（client），即上一节例子中的园艺公司、清洁公司。
（2）HTTP service：HTTP服务提供商，本文中简称"服务提供商"，即上一节例子中的别墅。
（3）Resource Owner：资源所有者，本文中又称"用户"（user）。
（4）User Agent：用户代理，本文中就是指浏览器。
（5）Authorization server：认证服务器，即服务提供商专门用来处理认证的服务器。
（6）Resource server：资源服务器，即服务提供商存放用户生成的资源的服务器。它与认证服务器，可以是同一台服务器，也可以是不同的服务器。

## 运行流程


（A）用户打开客户端以后，客户端要求用户给予授权。
（B）用户同意给予客户端授权。
（C）客户端使用上一步获得的授权，向认证服务器申请令牌。
（D）认证服务器对客户端进行认证以后，确认无误，同意发放令牌。
（E）客户端使用令牌，向资源服务器申请获取资源。
（F）资源服务器确认令牌无误，同意向客户端开放资源。

不难看出来，上面六个步骤之中，B是关键，即用户怎样才能给于客户端授权。有了这个授权以后，客户端就可以获取令牌，进而凭令牌获取资源

<!--stackedit_data:
eyJoaXN0b3J5IjpbLTE0ODI3MjQwNzUsLTMyMDY3MDM1LC0xNz
c5Nzg0NTIyXX0=
-->